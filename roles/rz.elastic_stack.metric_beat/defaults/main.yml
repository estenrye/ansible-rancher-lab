---
beat:
  config:
    modules:
      reload:
        enabled: false
        period: 10s
  setup:
      dashboards:
        enabled: true
      kibana:
        host: utility.rz.lab:5601
        protocol: http
        username: elastic
        password: changeme
  output:
    elasticsearch:
      hosts:
        - utility.rz.lab:9200
      protocol: http
      username: elastic
      password: changeme
  metricbeat:
    version: 6.4.3
    checksum: "sha256:3b4d3b309ca0cc13fed2ddcf40300cc67ffc726ca202a3dac7ace9b99520b77a"
    config_path: /etc/metricbeat

metricbeat:
  system:
    - module: system
      enabled: true
      period: 10s
      metricsets:
        - cpu             # CPU usage
        - load            # CPU load averages
        - memory          # Memory usage
        - network         # Network IO
        - process         # Per process metrics
        - process_summary # Process summary
        - uptime          # System Uptime
        #- core           # Per CPU core usage
        #- diskio         # Disk IO
        #- filesystem     # File system usage for each mountpoint
        #- fsstat         # File system summary metrics
        #- raid           # Raid
        #- socket         # Sockets and connection info (linux only)
      process:
        include_top_n:
          enabled: true
          by_cpu: 5      # include top 5 processes by CPU
          by_memory: 5   # include top 5 processes by memory

    - module: system
      enabled: true
      period: 1m
      metricsets:
        - filesystem
        - fsstat
      processors:
      - drop_event.when.regexp:
          system.filesystem.mount_point: '^/(sys|cgroup|proc|dev|etc|host|lib)($|/)'