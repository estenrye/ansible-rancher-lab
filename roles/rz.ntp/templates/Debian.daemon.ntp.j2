# {{ ansible_managed }}

# This the default chrony.conf file for the Debian chrony package.  After
# editing this file use the command 'invoke-rc.d chrony restart' to make
# your changes take effect.  John Hasler <jhasler@debian.org> 1998-2008

# Use public servers from the pool.ntp.org project.
# Please consider joining the pool (http://www.pool.ntp.org/join.html).
{% for item in ntp_servers %}
pool {{ item }}
{% endfor %}

# Look here for the admin password needed for chronyc.  The initial
# password is generated by a random process at install time.  You may
# change it if you wish.

keyfile /etc/chrony/chrony.keys

# This directive sets the key ID used for authenticating user commands via the
# 'chronyc' program at run time.

commandkey 1

# I moved the driftfile to /var/lib/chrony to comply with the Debian
# filesystem standard.

driftfile {{ntp_daemon_drift_file}}

# Comment this line out to turn off logging.

log {{ntp_daemon_log_options}}
logdir {{ntp_daemon_log_directory}}

# Stop bad estimates upsetting machine clock.

maxupdateskew {{ntp_daemon_maxupdateskew}}

# Dump measurements when daemon exits.

dumponexit

# Specify directory for dumping measurements.

dumpdir {{ntp_daemon_dump_directory}}

# This directive designates subnets (or nodes) from which NTP clients are allowed
# to access to 'chronyd'.

{% for item in ntp_daemon_allow %}
allow {{ item }}
{% endfor %}

# This directive forces `chronyd' to send a message to syslog if it
# makes a system clock adjustment larger than a threshold value in seconds.

logchange {{ntp_daemon_logchange}}

# This directive tells 'chronyd' to parse the 'adjtime' file to find out if the
# real-time clock keeps local time or UTC. It overrides the 'rtconutc' directive.

hwclockfile {{ntp_daemon_hwclock_file}}

# This directive enables kernel synchronisation (every 11 minutes) of the
# real-time clock. Note that it canâ€™t be used along with the 'rtcfile' directive.

rtcsync